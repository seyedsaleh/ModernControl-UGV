clc
clear all

syms('s' ,'k1', 'k2', 'k3', 'p1');
A = [0 0.1963 0;-0.1963 0 0.9817;0 0 0];
B = [0.025;0;-0.333];
C= [1 0 0]; 

K = [k1 k2 k3];
Ki = p1;

Abar = [A-B*K, B*Ki; -C, 0];
det(s*eye(4)-Abar);

% desired poles = [-4-j4, -4+j4, -20, -21]
s = solve([0.025*k1-0.333*k3 ==49, 0.03853369-0.3318136*k2+0.025*p1 ==780,0.06417166743*k1+0.01283171877*k3==-4672,-0.06417166743*p1==13440],[k1 k2 k3 p1]);
result = [s.k1,s.k2,s.k3,s.p1]

% full order observer, desired poles = [-21, -22, -23]
L = place([0 0.1963 0;-0.1963 0 0.9817;0 0 0]',[1 0 0]',[-21, -22, -23])';
